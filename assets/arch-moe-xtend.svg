<svg width="1440" height="288" viewBox="0 0 1440 288" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="MoE-Xtend architecture pipeline">
  <defs>
    <!-- Match MoE-Xtend repo/social visuals: pastel gradient + grid + tri-accent bar -->
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#F8FAFC" />
      <stop offset="45%" stop-color="#E0F2FE" />
      <stop offset="100%" stop-color="#FCE7F3" />
    </linearGradient>

    <linearGradient id="accent" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#06B6D4" />
      <stop offset="50%" stop-color="#8B5CF6" />
      <stop offset="100%" stop-color="#EC4899" />
    </linearGradient>

    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#CBD5E1" stroke-width="1" />
    </pattern>

    <filter id="shadow" x="-20%" y="-30%" width="140%" height="160%">
      <feDropShadow dx="0" dy="10" stdDeviation="10" flood-color="#0B1220" flood-opacity="0.14" />
    </filter>

    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur in="SourceGraphic" stdDeviation="5" result="b" />
      <feColorMatrix in="b" type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 0.55 0" result="g" />
      <feMerge>
        <feMergeNode in="g" />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>

    <linearGradient id="scan" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#FFFFFF" stop-opacity="0" />
      <stop offset="50%" stop-color="#FFFFFF" stop-opacity="0.36" />
      <stop offset="100%" stop-color="#FFFFFF" stop-opacity="0" />
    </linearGradient>

    <marker id="arrow" viewBox="0 0 12 12" refX="10.5" refY="6" markerWidth="10" markerHeight="10" orient="auto" markerUnits="strokeWidth">
      <path d="M1.25 1.25 L10.5 6 L1.25 10.75" fill="none" stroke="#06B6D4" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round" />
    </marker>
  </defs>

  <rect width="1440" height="288" fill="url(#bg)" rx="19" />
  <rect width="1440" height="288" fill="url(#grid)" opacity="0.22" rx="19" />

  <g filter="url(#shadow)">
    <rect x="18" y="18" width="1404" height="252" rx="22" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
  </g>

  <rect x="18" y="18" width="1404" height="6" rx="22" fill="url(#accent)" opacity="0.95" />

  <text x="40" y="56" fill="#0B1220" font-size="18" font-weight="800" font-family="Space Grotesk, Helvetica, Arial, sans-serif" letter-spacing="0.4">
    ARCHITECTURE PIPELINE
  </text>
  <text x="1400" y="56" text-anchor="end" fill="#334155" font-size="13" font-weight="800"
        font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
    MoE-Xtend
  </text>

  <!-- Animated routing/throughput line (dash stream) -->
  <line x1="64" y1="206" x2="1390" y2="206" stroke="url(#accent)" stroke-width="4" stroke-linecap="round" stroke-dasharray="14 18" opacity="0.82">
    <animate attributeName="stroke-dashoffset" values="0;64" dur="2.4s" repeatCount="indefinite" />
  </line>

  <!-- Token stream pulses -->
  <g filter="url(#glow)" opacity="0.95">
    <circle cx="84" cy="206" r="6" fill="#06B6D4">
      <animate attributeName="cx" values="84;1380" dur="2.8s" repeatCount="indefinite" />
      <animate attributeName="opacity" values="0.3;0.9;0.3" dur="2.8s" repeatCount="indefinite" />
    </circle>
    <circle cx="84" cy="206" r="6" fill="#8B5CF6">
      <animate attributeName="cx" values="84;1380" dur="2.8s" begin="0.75s" repeatCount="indefinite" />
      <animate attributeName="opacity" values="0.25;0.85;0.25" dur="2.8s" begin="0.75s" repeatCount="indefinite" />
    </circle>
    <circle cx="84" cy="206" r="6" fill="#EC4899">
      <animate attributeName="cx" values="84;1380" dur="2.8s" begin="1.5s" repeatCount="indefinite" />
      <animate attributeName="opacity" values="0.22;0.8;0.22" dur="2.8s" begin="1.5s" repeatCount="indefinite" />
    </circle>
  </g>

  <!-- Arrows between boxes -->
  <g fill="none" stroke="#06B6D4" stroke-width="2.4" stroke-linecap="round" stroke-opacity="0.9" marker-end="url(#arrow)" filter="url(#glow)">
    <line x1="217" y1="131" x2="229" y2="131" />
    <line x1="385" y1="131" x2="397" y2="131" />
    <line x1="553" y1="131" x2="565" y2="131" />
    <line x1="721" y1="131" x2="733" y2="131" />
    <line x1="889" y1="131" x2="901" y2="131" />
    <line x1="1057" y1="131" x2="1069" y2="131" />
    <line x1="1225" y1="131" x2="1237" y2="131" />
  </g>

  <!-- Boxes -->
  <g>
    <!-- Box template: white card + accent strip -->
    <g transform="translate(64 72)">
      <rect x="0" y="0" width="150" height="118" rx="16" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
      <rect x="0" y="0" width="150" height="5" rx="16" fill="url(#accent)" opacity="0.95" />
      <text x="75" y="46" text-anchor="middle" fill="#0B1220" font-weight="800" font-size="15.2" letter-spacing="0.3"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">HARMONY</tspan>
      </text>
      <text x="75" y="68" text-anchor="middle" fill="#334155" font-weight="800" font-size="11.8"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">messages -&gt; spec</tspan>
      </text>
    </g>

    <g transform="translate(232 72)">
      <rect x="0" y="0" width="150" height="118" rx="16" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
      <rect x="0" y="0" width="150" height="5" rx="16" fill="url(#accent)" opacity="0.95" />
      <text x="75" y="44" text-anchor="middle" fill="#0B1220" font-weight="800" font-size="15.0" letter-spacing="0.3"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">TOKENIZER</tspan>
      </text>
      <text x="75" y="68" text-anchor="middle" fill="#334155" font-weight="800" font-size="11.8"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">ids + masks</tspan>
      </text>
    </g>

    <g transform="translate(400 72)">
      <rect x="0" y="0" width="150" height="118" rx="16" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
      <rect x="0" y="0" width="150" height="5" rx="16" fill="url(#accent)" opacity="0.95" />
      <text x="75" y="44" text-anchor="middle" fill="#0B1220" font-weight="800" font-size="15.0" letter-spacing="0.3"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">PREFILL</tspan>
      </text>
      <text x="75" y="68" text-anchor="middle" fill="#334155" font-weight="800" font-size="11.8"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">build KV prefix</tspan>
      </text>
    </g>

    <g transform="translate(568 72)">
      <rect x="0" y="0" width="150" height="118" rx="16" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
      <rect x="0" y="0" width="150" height="5" rx="16" fill="url(#accent)" opacity="0.95" />
      <text x="75" y="30" text-anchor="middle" fill="#0B1220" font-weight="800" font-size="14.6" letter-spacing="0.25"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">ATTENTION</tspan>
      </text>
      <text x="75" y="54" text-anchor="middle" fill="#334155" font-weight="800" font-size="11.2"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">RoPE / GQA / window</tspan>
        <tspan x="75" dy="15">sinks + bias</tspan>
      </text>
    </g>

    <g transform="translate(736 72)">
      <rect x="0" y="0" width="150" height="118" rx="16" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
      <rect x="0" y="0" width="150" height="5" rx="16" fill="url(#accent)" opacity="0.95" />
      <text x="75" y="30" text-anchor="middle" fill="#0B1220" font-weight="800" font-size="14.2" letter-spacing="0.25"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">MoE ROUTER</tspan>
      </text>
      <text x="75" y="54" text-anchor="middle" fill="#334155" font-weight="800" font-size="11.4"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">top-k experts</tspan>
        <tspan x="75" dy="15">dispatch + merge</tspan>
      </text>
    </g>

    <g transform="translate(904 72)">
      <rect x="0" y="0" width="150" height="118" rx="16" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
      <rect x="0" y="0" width="150" height="5" rx="16" fill="url(#accent)" opacity="0.95" />
      <text x="75" y="30" text-anchor="middle" fill="#0B1220" font-weight="800" font-size="14.4" letter-spacing="0.25"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">DECODE LOOP</tspan>
      </text>
      <text x="75" y="54" text-anchor="middle" fill="#334155" font-weight="800" font-size="11.1"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">append KV @ offset t</tspan>
      </text>
    </g>

    <g transform="translate(1072 72)">
      <rect x="0" y="0" width="150" height="118" rx="16" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
      <rect x="0" y="0" width="150" height="5" rx="16" fill="url(#accent)" opacity="0.95" />
      <text x="75" y="30" text-anchor="middle" fill="#0B1220" font-weight="800" font-size="14.7" letter-spacing="0.25"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">SAMPLING</tspan>
      </text>
      <text x="75" y="54" text-anchor="middle" fill="#334155" font-weight="800" font-size="11.4"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">top-p / min-p</tspan>
        <tspan x="75" dy="15">penalties</tspan>
      </text>
    </g>

    <g transform="translate(1240 72)">
      <rect x="0" y="0" width="150" height="118" rx="16" fill="#FFFFFF" opacity="0.78" stroke="#0B1220" stroke-width="2" />
      <rect x="0" y="0" width="150" height="5" rx="16" fill="url(#accent)" opacity="0.95" />
      <text x="75" y="30" text-anchor="middle" fill="#0B1220" font-weight="800" font-size="14.7" letter-spacing="0.25"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">OUTPUTS</tspan>
      </text>
      <text x="75" y="54" text-anchor="middle" fill="#334155" font-weight="800" font-size="11.4"
            font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace">
        <tspan x="75" dy="0">text + JSON</tspan>
        <tspan x="75" dy="15">logprobs</tspan>
      </text>
    </g>
  </g>

  <text x="720" y="258" text-anchor="middle" fill="#0B1220" opacity="0.92"
        font-family="JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace"
        font-size="13" font-weight="800">
    bytes ~= 2 * L * B * T * H_kv * d * dtype_bytes
  </text>

  <!-- Scanline over the card -->
  <rect x="18" y="18" width="1404" height="40" fill="url(#scan)" opacity="0.22">
    <animate attributeName="y" dur="6.4s" repeatCount="indefinite" values="18;230;18" keyTimes="0;0.5;1" calcMode="spline"
             keySplines="0.42 0 0.58 1;0.42 0 0.58 1" />
  </rect>
</svg>

