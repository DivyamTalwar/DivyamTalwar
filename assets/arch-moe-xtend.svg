<svg width="1440" height="288" viewBox="0 0 1440 288" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="MoE-Xtend architecture pipeline"> <defs> <linearGradient id="bg" x1="0" y1="0" x2="1440" y2="288" gradientUnits="userSpaceOnUse"> <stop offset="0" stop-color="#0b0f1a"/> <stop offset="1" stop-color="#0b1b2d"/> </linearGradient>
<linearGradient id="sheen" x1="0" y1="72" x2="0" y2="190" gradientUnits="userSpaceOnUse">
  <stop offset="0" stop-color="#06b6d4" stop-opacity="0.22"/>
  <stop offset="0.55" stop-color="#06b6d4" stop-opacity="0.10"/>
  <stop offset="1" stop-color="#06b6d4" stop-opacity="0.04"/>
</linearGradient>

<filter id="glow" x="-30%" y="-50%" width="160%" height="200%">
  <feGaussianBlur in="SourceGraphic" stdDeviation="2.2" result="blur"/>
  <feMerge>
    <feMergeNode in="blur"/>
    <feMergeNode in="SourceGraphic"/>
  </feMerge>
</filter>

<marker id="arrow" viewBox="0 0 12 12" refX="10.5" refY="6" markerWidth="8" markerHeight="8" orient="auto" markerUnits="strokeWidth">
  <path d="M1.25 1.25 L10.5 6 L1.25 10.75" fill="none" stroke="#06b6d4" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
</marker>

</defs> <rect width="1440" height="288" fill="url(#bg)" rx="19"/> <rect x="10" y="10" width="1421" height="269" fill="none" stroke="#1f2937" stroke-width="1" rx="17"/> <rect x="18" y="18" width="1405" height="253" fill="none" stroke="#1f2937" stroke-opacity="0.35" stroke-width="1" rx="15"/> <!-- subtle shimmer across pipeline --> <line x1="64" y1="131" x2="1390" y2="131" stroke="#06b6d4" stroke-opacity="0.14" stroke-width="1.2" stroke-dasharray="10 18" stroke-linecap="round"> <animate attributeName="stroke-dashoffset" from="0" to="-560" dur="8.5s" repeatCount="indefinite"/> </line> <!-- arrows between boxes --> <g stroke="#06b6d4" stroke-opacity="0.85" stroke-width="1.6" stroke-linecap="round" marker-end="url(#arrow)" filter="url(#glow)"> <line x1="220" y1="131" x2="226" y2="131"/> <line x1="388" y1="131" x2="394" y2="131"/> <line x1="556" y1="131" x2="562" y2="131"/> <line x1="724" y1="131" x2="730" y2="131"/> <line x1="892" y1="131" x2="898" y2="131"/> <line x1="1060" y1="131" x2="1066" y2="131"/> <line x1="1228" y1="131" x2="1234" y2="131"/> </g> <!-- boxes --> <g font-family="Segoe UI, Arial, sans-serif" fill="#e6edf3"> <!-- Box 1 --> <g transform="translate(64 72)"> <rect x="0" y="0" width="150" height="118" rx="16" fill="#06b6d4" fill-opacity="0.16"/> <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#1f2937" stroke-width="1"/> <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#06b6d4" stroke-opacity="0.9" stroke-width="1.6" filter="url(#glow)"/> <rect x="8" y="8" width="134" height="102" rx="12" fill="url(#sheen)" opacity="0.55"/> <text x="75" y="46" text-anchor="middle" font-weight="800" font-size="15.5" letter-spacing="0.3"> <tspan x="75" dy="0">HARMONY</tspan> </text> <text x="75" y="68" text-anchor="middle" font-weight="600" font-size="12.2" opacity="0.95"> <tspan x="75" dy="0">messages -&gt; spec</tspan> </text> </g>
<!-- Box 2 -->
<g transform="translate(232 72)">
  <rect x="0" y="0" width="150" height="118" rx="16" fill="#06b6d4" fill-opacity="0.16"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#1f2937" stroke-width="1"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#06b6d4" stroke-opacity="0.9" stroke-width="1.6" filter="url(#glow)"/>
  <rect x="8" y="8" width="134" height="102" rx="12" fill="url(#sheen)" opacity="0.55"/>
  <text x="75" y="44" text-anchor="middle" font-weight="800" font-size="15.2" letter-spacing="0.3">
    <tspan x="75" dy="0">TOKENIZER</tspan>
  </text>
  <text x="75" y="68" text-anchor="middle" font-weight="600" font-size="12.2" opacity="0.95">
    <tspan x="75" dy="0">ids + masks</tspan>
  </text>
</g>

<!-- Box 3 -->
<g transform="translate(400 72)">
  <rect x="0" y="0" width="150" height="118" rx="16" fill="#06b6d4" fill-opacity="0.16"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#1f2937" stroke-width="1"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#06b6d4" stroke-opacity="0.9" stroke-width="1.6" filter="url(#glow)"/>
  <rect x="8" y="8" width="134" height="102" rx="12" fill="url(#sheen)" opacity="0.55"/>
  <text x="75" y="44" text-anchor="middle" font-weight="800" font-size="15.2" letter-spacing="0.3">
    <tspan x="75" dy="0">PREFILL</tspan>
  </text>
  <text x="75" y="68" text-anchor="middle" font-weight="600" font-size="12.2" opacity="0.95">
    <tspan x="75" dy="0">build KV prefix</tspan>
  </text>
</g>

<!-- Box 4 -->
<g transform="translate(568 72)">
  <rect x="0" y="0" width="150" height="118" rx="16" fill="#06b6d4" fill-opacity="0.16"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#1f2937" stroke-width="1"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#06b6d4" stroke-opacity="0.9" stroke-width="1.6" filter="url(#glow)"/>
  <rect x="8" y="8" width="134" height="102" rx="12" fill="url(#sheen)" opacity="0.55"/>
  <text x="75" y="30" text-anchor="middle" font-weight="800" font-size="15.0" letter-spacing="0.25">
    <tspan x="75" dy="0">ATTENTION</tspan>
  </text>
  <text x="75" y="54" text-anchor="middle" font-weight="600" font-size="11.6" opacity="0.95">
    <tspan x="75" dy="0">RoPE / GQA / window</tspan>
    <tspan x="75" dy="15">sinks + bias</tspan>
  </text>
</g>

<!-- Box 5 -->
<g transform="translate(736 72)">
  <rect x="0" y="0" width="150" height="118" rx="16" fill="#06b6d4" fill-opacity="0.16"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#1f2937" stroke-width="1"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#06b6d4" stroke-opacity="0.9" stroke-width="1.6" filter="url(#glow)"/>
  <rect x="8" y="8" width="134" height="102" rx="12" fill="url(#sheen)" opacity="0.55"/>
  <text x="75" y="30" text-anchor="middle" font-weight="800" font-size="14.6" letter-spacing="0.25">
    <tspan x="75" dy="0">MoE ROUTER</tspan>
  </text>
  <text x="75" y="54" text-anchor="middle" font-weight="600" font-size="11.8" opacity="0.95">
    <tspan x="75" dy="0">top-k experts</tspan>
    <tspan x="75" dy="15">dispatch + merge</tspan>
  </text>
</g>

<!-- Box 6 -->
<g transform="translate(904 72)">
  <rect x="0" y="0" width="150" height="118" rx="16" fill="#06b6d4" fill-opacity="0.16"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#1f2937" stroke-width="1"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#06b6d4" stroke-opacity="0.9" stroke-width="1.6" filter="url(#glow)"/>
  <rect x="8" y="8" width="134" height="102" rx="12" fill="url(#sheen)" opacity="0.55"/>
  <text x="75" y="30" text-anchor="middle" font-weight="800" font-size="14.8" letter-spacing="0.25">
    <tspan x="75" dy="0">DECODE LOOP</tspan>
  </text>
  <text x="75" y="54" text-anchor="middle" font-weight="600" font-size="11.5" opacity="0.95">
    <tspan x="75" dy="0">append KV @ offset t</tspan>
  </text>
</g>

<!-- Box 7 -->
<g transform="translate(1072 72)">
  <rect x="0" y="0" width="150" height="118" rx="16" fill="#06b6d4" fill-opacity="0.16"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#1f2937" stroke-width="1"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#06b6d4" stroke-opacity="0.9" stroke-width="1.6" filter="url(#glow)"/>
  <rect x="8" y="8" width="134" height="102" rx="12" fill="url(#sheen)" opacity="0.55"/>
  <text x="75" y="30" text-anchor="middle" font-weight="800" font-size="15.1" letter-spacing="0.25">
    <tspan x="75" dy="0">SAMPLING</tspan>
  </text>
  <text x="75" y="54" text-anchor="middle" font-weight="600" font-size="11.8" opacity="0.95">
    <tspan x="75" dy="0">top-p / min-p</tspan>
    <tspan x="75" dy="15">penalties</tspan>
  </text>
</g>

<!-- Box 8 -->
<g transform="translate(1240 72)">
  <rect x="0" y="0" width="150" height="118" rx="16" fill="#06b6d4" fill-opacity="0.16"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#1f2937" stroke-width="1"/>
  <rect x="0.5" y="0.5" width="149" height="117" rx="15.5" fill="none" stroke="#06b6d4" stroke-opacity="0.9" stroke-width="1.6" filter="url(#glow)"/>
  <rect x="8" y="8" width="134" height="102" rx="12" fill="url(#sheen)" opacity="0.55"/>
  <text x="75" y="30" text-anchor="middle" font-weight="800" font-size="15.1" letter-spacing="0.25">
    <tspan x="75" dy="0">OUTPUTS</tspan>
  </text>
  <text x="75" y="54" text-anchor="middle" font-weight="600" font-size="11.8" opacity="0.95">
    <tspan x="75" dy="0">text + JSON</tspan>
    <tspan x="75" dy="15">logprobs</tspan>
  </text>
</g>

</g> <!-- footer formula -->

<text x="720" y="246" text-anchor="middle" fill="#e6edf3" opacity="0.92" font-family="ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace" font-size="14" font-weight="600">
bytes ~= 2 * L * B * T * H_kv * d * dtype_bytes
</text>
</svg>
